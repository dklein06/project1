@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ commande

pi@pi2b:~/py_test $ python sdp_browse.py 25:CF:58:AC:62:61

@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ debut sniff


< HCI Command: Create Connection (0x01|0x0005) plen 13
    bdaddr 25:CF:58:AC:62:61 ptype 0xcc18 rswitch 0x01 clkoffset 0x0000
    Packet type: DM1 DM3 DM5 DH1 DH3 DH5 
> HCI Event: Command Status (0x0f) plen 4
    Create Connection (0x01|0x0005) status 0x00 ncmd 1
> HCI Event: Connect Complete (0x03) plen 11
    status 0x00 handle 71 bdaddr 25:CF:58:AC:62:61 type ACL encrypt 0x00
< HCI Command: Read Remote Supported Features (0x01|0x001b) plen 2
    handle 71
> HCI Event: Command Status (0x0f) plen 4
    Read Remote Supported Features (0x01|0x001b) status 0x00 ncmd 0
> HCI Event: Max Slots Change (0x1b) plen 3
    handle 71 slots 5
> HCI Event: Command Status (0x0f) plen 4
    Unknown (0x00|0x0000) status 0x00 ncmd 1
> HCI Event: Read Remote Supported Features (0x0b) plen 11
    status 0x00 handle 71
    Features: 0xbf 0x3e 0x8d 0xfe 0x9b 0xff 0x59 0x87
< HCI Command: Read Remote Extended Features (0x01|0x001c) plen 3
    handle 71 page 1
> HCI Event: Command Status (0x0f) plen 4
    Read Remote Extended Features (0x01|0x001c) status 0x00 ncmd 1
> HCI Event: Read Remote Extended Features (0x23) plen 13
    status 0x00 handle 71 page 1 max 2
    Features: 0x01 0x00 0x00 0x00 0x00 0x00 0x00 0x00
< HCI Command: Remote Name Request (0x01|0x0019) plen 10
    bdaddr 25:CF:58:AC:62:61 mode 2 clkoffset 0x0000
< ACL data: handle 71 flags 0x00 dlen 10
    L2CAP(s): Info req: type 2
> HCI Event: Command Status (0x0f) plen 4
    Remote Name Request (0x01|0x0019) status 0x00 ncmd 1
> ACL data: handle 71 flags 0x02 dlen 16
    L2CAP(s): Info rsp: type 2 result 0
      Extended feature mask 0x0200
        Unicast Connectless Data Reception
> HCI Event: Number of Completed Packets (0x13) plen 5
    handle 71 packets 1
< ACL data: handle 71 flags 0x00 dlen 12
    L2CAP(s): Connect req: psm 1 scid 0x0040
> HCI Event: Number of Completed Packets (0x13) plen 5
    handle 71 packets 1
> ACL data: handle 71 flags 0x02 dlen 16
    L2CAP(s): Connect rsp: dcid 0x0040 scid 0x0040 result 0 status 0
      Connection successful
< ACL data: handle 71 flags 0x00 dlen 12
    L2CAP(s): Config req: dcid 0x0040 flags 0x00 clen 0
> ACL data: handle 71 flags 0x02 dlen 16
    L2CAP(s): Config req: dcid 0x0040 flags 0x00 clen 4
      MTU 1021 
< ACL data: handle 71 flags 0x00 dlen 18
    L2CAP(s): Config rsp: scid 0x0040 flags 0x00 result 0 clen 4
      MTU 1021 
> ACL data: handle 71 flags 0x02 dlen 14
    L2CAP(s): Config rsp: scid 0x0040 flags 0x00 result 0 clen 0
      Success
< ACL data: handle 71 flags 0x00 dlen 24
    L2CAP(d): cid 0x0040 len 20 [psm 1]
        SDP SSA Req: tid 0x0 len 0xf
          pat uuid-16 0x1002 (PubBrwsGrp)
          max 65535
          aid(s) 0x0000 - 0xffff
          cont 00
> HCI Event: Remote Name Req Complete (0x07) plen 255
    status 0x00 bdaddr 25:CF:58:AC:62:61 name 'Q18'
> HCI Event: Number of Completed Packets (0x13) plen 5
    handle 71 packets 1
> HCI Event: Number of Completed Packets (0x13) plen 5
    handle 71 packets 1
> HCI Event: Number of Completed Packets (0x13) plen 5
    handle 71 packets 1
> ACL data: handle 71 flags 0x02 dlen 132
    L2CAP(d): cid 0x0040 len 128 [psm 1]
        SDP SSA Rsp: tid 0x0 len 0x7b
          count 119
          cont 01 16
< ACL data: handle 71 flags 0x00 dlen 25
    L2CAP(d): cid 0x0040 len 21 [psm 1]
        SDP SSA Req: tid 0x1 len 0x10
          pat uuid-16 0x1002 (PubBrwsGrp)
          max 65535
          aid(s) 0x0000 - 0xffff
          cont 01 16
> HCI Event: Number of Completed Packets (0x13) plen 5
    handle 71 packets 1
> ACL data: handle 71 flags 0x02 dlen 132
    L2CAP(d): cid 0x0040 len 128 [psm 1]
        SDP SSA Rsp: tid 0x1 len 0x7b
          count 119
          cont 01 17
< ACL data: handle 71 flags 0x00 dlen 25
    L2CAP(d): cid 0x0040 len 21 [psm 1]
        SDP SSA Req: tid 0x2 len 0x10
          pat uuid-16 0x1002 (PubBrwsGrp)
          max 65535
          aid(s) 0x0000 - 0xffff
          cont 01 17
> HCI Event: Number of Completed Packets (0x13) plen 5
    handle 71 packets 1
> ACL data: handle 71 flags 0x02 dlen 132
    L2CAP(d): cid 0x0040 len 128 [psm 1]
        SDP SSA Rsp: tid 0x2 len 0x7b
          count 119
          cont 01 18
< ACL data: handle 71 flags 0x00 dlen 25
    L2CAP(d): cid 0x0040 len 21 [psm 1]
        SDP SSA Req: tid 0x3 len 0x10
          pat uuid-16 0x1002 (PubBrwsGrp)
          max 65535
          aid(s) 0x0000 - 0xffff
          cont 01 18
> HCI Event: Number of Completed Packets (0x13) plen 5
    handle 71 packets 1
> ACL data: handle 71 flags 0x02 dlen 132
    L2CAP(d): cid 0x0040 len 128 [psm 1]
        SDP SSA Rsp: tid 0x3 len 0x7b
          count 119
          cont 01 19
< ACL data: handle 71 flags 0x00 dlen 25
    L2CAP(d): cid 0x0040 len 21 [psm 1]
        SDP SSA Req: tid 0x4 len 0x10
          pat uuid-16 0x1002 (PubBrwsGrp)
          max 65535
          aid(s) 0x0000 - 0xffff
          cont 01 19
> HCI Event: Number of Completed Packets (0x13) plen 5
    handle 71 packets 1
> ACL data: handle 71 flags 0x02 dlen 132
    L2CAP(d): cid 0x0040 len 128 [psm 1]
        SDP SSA Rsp: tid 0x4 len 0x7b
          count 119
          cont 01 1A
< ACL data: handle 71 flags 0x00 dlen 25
    L2CAP(d): cid 0x0040 len 21 [psm 1]
        SDP SSA Req: tid 0x5 len 0x10
          pat uuid-16 0x1002 (PubBrwsGrp)
          max 65535
          aid(s) 0x0000 - 0xffff
          cont 01 1A
> HCI Event: Number of Completed Packets (0x13) plen 5
    handle 71 packets 1
> ACL data: handle 71 flags 0x02 dlen 132
    L2CAP(d): cid 0x0040 len 128 [psm 1]
        SDP SSA Rsp: tid 0x5 len 0x7b
          count 119
          cont 01 1B
< ACL data: handle 71 flags 0x00 dlen 25
    L2CAP(d): cid 0x0040 len 21 [psm 1]
        SDP SSA Req: tid 0x6 len 0x10
          pat uuid-16 0x1002 (PubBrwsGrp)
          max 65535
          aid(s) 0x0000 - 0xffff
          cont 01 1B
> ACL data: handle 71 flags 0x02 dlen 132
    L2CAP(d): cid 0x0040 len 128 [psm 1]
        SDP SSA Rsp: tid 0x6 len 0x7b
          count 119
          cont 01 1C
> HCI Event: Number of Completed Packets (0x13) plen 5
    handle 71 packets 1
< ACL data: handle 71 flags 0x00 dlen 25
    L2CAP(d): cid 0x0040 len 21 [psm 1]
        SDP SSA Req: tid 0x7 len 0x10
          pat uuid-16 0x1002 (PubBrwsGrp)
          max 65535
          aid(s) 0x0000 - 0xffff
          cont 01 1C
> HCI Event: Number of Completed Packets (0x13) plen 5
    handle 71 packets 1
> ACL data: handle 71 flags 0x02 dlen 88
    L2CAP(d): cid 0x0040 len 84 [psm 1]
        SDP SSA Rsp: tid 0x7 len 0x4f
          count 76
          record #0
              aid 0x0000 (SrvRecHndl)
                 uint 0x10001
              aid 0x0001 (SrvClassIDList)
                 < uuid-16 0x111f (Handsfree AG) uuid-16 0x1203 (Audio) >
              aid 0x0002 (SrvRecState)
                 uint 0xa54
              aid 0x0004 (ProtocolDescList)
                 < < uuid-16 0x0100 (L2CAP) > <
                 uuid-16 0x0003 (RFCOMM) uint 0x2 > >
              aid 0x0005 (BrwGrpList)
                 < uuid-16 0x1002 (PubBrwsGrp) >
              aid 0x0006 (LangBaseAttrIDList)
                 < uint 0x656e uint 0x6a uint 0x100 >
              aid 0x0009 (BTProfileDescList)
                 < < uuid-16 0x111e (Handsfree) uint 0x105 > >
              aid 0x0100 (SrvName)
                 str "Voiceg ateway"
              aid 0x0301 (SuppDataStoresList)
                 uint 0x1
              aid 0x0311 (SuppFeatures)
                 uint 0x1
          record #1
              aid 0x0000 (SrvRecHndl)
                 uint 0x10002
              aid 0x0001 (SrvClassIDList)
                 < uuid-16 0x1112 (Headset AG) uuid-16 0x1203 (Audio) >
              aid 0x0002 (SrvRecState)
                 uint 0xa54
              aid 0x0004 (ProtocolDescList)
                 < < uuid-16 0x0100 (L2CAP) > <
                 uuid-16 0x0003 (RFCOMM) uint 0x1 > >
              aid 0x0005 (BrwGrpList)
                 < uuid-16 0x1002 (PubBrwsGrp) >
              aid 0x0006 (LangBaseAttrIDList)
                 < uint 0x656e uint 0x6a uint 0x100 >
              aid 0x0009 (BTProfileDescList)
                 < < uuid-16 0x1108 (Headset) uint 0x102 > >
              aid 0x0100 (SrvName)
                 str "AUDIO Gateway"
          record #2
              aid 0x0000 (SrvRecHndl)
                 uint 0x10003
              aid 0x0001 (SrvClassIDList)
                 < uuid-16 0x1101 (SP) >
              aid 0x0002 (SrvRecState)
                 uint 0xa55
              aid 0x0004 (ProtocolDescList)
                 < < uuid-16 0x0100 (L2CAP) > <
                 uuid-16 0x0003 (RFCOMM) uint 0xf > >
              aid 0x0005 (BrwGrpList)
                 < uuid-16 0x1002 (PubBrwsGrp) >
              aid 0x0006 (LangBaseAttrIDList)
                 < uint 0x656e uint 0x6a uint 0x100 >
              aid 0x0100 (SrvName)
                 str "Serial Port0"
          record #3
              aid 0x0000 (SrvRecHndl)
                 uint 0x10004
              aid 0x0001 (SrvClassIDList)
                 < uuid-16 0x1101 (SP) >
              aid 0x0002 (SrvRecState)
                 uint 0xa55
              aid 0x0004 (ProtocolDescList)
                 < < uuid-16 0x0100 (L2CAP) > <
                 uuid-16 0x0003 (RFCOMM) uint 0x10 > >
              aid 0x0005 (BrwGrpList)
                 < uuid-16 0x1002 (PubBrwsGrp) >
              aid 0x0006 (LangBaseAttrIDList)
                 < uint 0x656e uint 0x6a uint 0x100 >
              aid 0x0100 (SrvName)
                 str "Serial Port1"
          record #4
              aid 0x0000 (SrvRecHndl)
                 uint 0x10005
              aid 0x0001 (SrvClassIDList)
                 < uuid-16 0x110a (AudioSource) >
              aid 0x0002 (SrvRecState)
                 uint 0xa56
              aid 0x0004 (ProtocolDescList)
                 < < uuid-16 0x0100 (L2CAP) uint 0x19 > <
                 uuid-16 0x0019 (AVDTP) uint 0x100 > >
              aid 0x0005 (BrwGrpList)
                 < uuid-16 0x1002 (PubBrwsGrp) >
              aid 0x0009 (BTProfileDescList)
                 < < uuid-16 0x110d (AdvAudio) uint 0x100 > >
              aid 0x0100 (SrvName)
                 str "Advanced Audio"
          record #5
              aid 0x0000 (SrvRecHndl)
                 uint 0x10006
              aid 0x0001 (SrvClassIDList)
                 < uuid-16 0x110b (AudioSink) >
              aid 0x0002 (SrvRecState)
                 uint 0xa56
              aid 0x0004 (ProtocolDescList)
                 < < uuid-16 0x0100 (L2CAP) uint 0x19 > <
                 uuid-16 0x0019 (AVDTP) uint 0x100 > >
              aid 0x0005 (BrwGrpList)
                 < uuid-16 0x1002 (PubBrwsGrp) >
              aid 0x0009 (BTProfileDescList)
                 < < uuid-16 0x110d (AdvAudio) uint 0x100 > >
              aid 0x0100 (SrvName)
                 str "Advanced Audio"
          record #6
              aid 0x0000 (SrvRecHndl)
                 uint 0x10007
              aid 0x0001 (SrvClassIDList)
                 < uuid-16 0x110c (AVRemTarget) >
              aid 0x0002 (SrvRecState)
                 uint 0xa56
              aid 0x0004 (ProtocolDescList)
                 < < uuid-16 0x0100 (L2CAP) uint 0x17 > <
                 uuid-16 0x0017 (AVCTP) uint 0x102 > >
              aid 0x0005 (BrwGrpList)
                 < uuid-16 0x1002 (PubBrwsGrp) >
              aid 0x0009 (BTProfileDescList)
                 < < uuid-16 0x110e (AVRemote) uint 0x100 > >
              aid 0x0311 (SuppFeatures)
                 uint 0x21
          record #7
              aid 0x0000 (SrvRecHndl)
                 uint 0x10008
              aid 0x0001 (SrvClassIDList)
                 < uuid-16 0x110e (AVRemote) >
              aid 0x0002 (SrvRecState)
                 uint 0xa56
              aid 0x0004 (ProtocolDescList)
                 < < uuid-16 0x0100 (L2CAP) uint 0x17 > <
                 uuid-16 0x0017 (AVCTP) uint 0x102 > >
              aid 0x0005 (BrwGrpList)
                 < uuid-16 0x1002 (PubBrwsGrp) >
              aid 0x0009 (BTProfileDescList)
                 < < uuid-16 0x110e (AVRemote) uint 0x103 > >
              aid 0x0311 (SuppFeatures)
                 uint 0xf
          record #8
              aid 0x0000 (SrvRecHndl)
                 uint 0x1000a
              aid 0x0001 (SrvClassIDList)
                 < uuid-16 0x111e (Handsfree) uuid-16 0x1203 (Audio) >
              aid 0x0002 (SrvRecState)
                 uint 0xa57
              aid 0x0004 (ProtocolDescList)
                 < < uuid-16 0x0100 (L2CAP) > <
                 uuid-16 0x0003 (RFCOMM) uint 0x3 > >
              aid 0x0005 (BrwGrpList)
                 < uuid-16 0x1002 (PubBrwsGrp) >
              aid 0x0006 (LangBaseAttrIDList)
                 < uint 0x656e uint 0x6a uint 0x100 >
              aid 0x0009 (BTProfileDescList)
                 < < uuid-16 0x111e (Handsfree) uint 0x105 > >
              aid 0x0100 (SrvName)
                 str "Hands-Free unit"
              aid 0x0311 (SuppFeatures)
                 uint 0x16
          record #9
              aid 0x0000 (SrvRecHndl)
                 uint 0x1000b
              aid 0x0001 (SrvClassIDList)
                 < uuid-16 0x1105 (OBEXObjPush) >
              aid 0x0002 (SrvRecState)
                 uint 0xa58
              aid 0x0004 (ProtocolDescList)
                 < < uuid-16 0x0100 (L2CAP) > <
                 uuid-16 0x0003 (RFCOMM) uint 0x5 > <
                 uuid-16 0x0008 (OBEX) > >
              aid 0x0005 (BrwGrpList)
                 < uuid-16 0x1002 (PubBrwsGrp) >
              aid 0x0006 (LangBaseAttrIDList)
                 < uint 0x656e uint 0x6a uint 0x100 >
              aid 0x0100 (SrvName)
                 str "OBEX Object Push"
              aid 0x0303 (SuppFormatsList)
                 < uint 0xff >
          cont 00
< ACL data: handle 71 flags 0x00 dlen 12
    L2CAP(s): Disconn req: dcid 0x0040 scid 0x0040
> HCI Event: Number of Completed Packets (0x13) plen 5
    handle 71 packets 1
> ACL data: handle 71 flags 0x02 dlen 12
    L2CAP(s): Disconn rsp: dcid 0x0040 scid 0x0040
< HCI Command: Disconnect (0x01|0x0006) plen 3
    handle 71 reason 0x13
    Reason: Remote User Terminated Connection
> HCI Event: Command Status (0x0f) plen 4
    Disconnect (0x01|0x0006) status 0x00 ncmd 1
> HCI Event: Disconn Complete (0x05) plen 4
    status 0x00 handle 71 reason 0x16
    Reason: Connection Terminated by Local Host


